@page "/clients"
@using CroBooks.Shared.Dto
@using CroBooks.Web.Components.Clients

@inherits AppComponentBase
@implements IDisposable

<PageHeading>@Localize("Clients_Title")</PageHeading>

<MudButton OnClick="AddClientClick">@LocalizeElement("ButtonAddNew")</MudButton>

<ClientList ClientDtoList="clients" ></ClientList>

@code {
    [Inject] public HttpInterceptorService interceptor { get; set; } = null!;
    [Inject] public ClientHttpClient httpClient { get; set; } = null!;
    [Inject] public IDialogService DialogService { get; set; } = null!;

    private List<ClientDto> clients = new();

    protected async override Task OnInitializedAsync()
    {
        interceptor.RegisterEvent();

        clients = await httpClient.GetClients();
    }

    public void Dispose()
    {
        interceptor.DisposeEvent();
    }

    private async Task AddClientClick()
    {
        await DialogService.ShowAsync<ClientDialog>("Simple Dialog", new DialogOptions());
    }
}
